{"ast":null,"code":"import axios from'../utils/axios';import updateObject from'../utils/updateObject';/**************************************************************************\n * Se definen los action types\n */export var AUTH_START='AUTH_START';export var AUTH_SUCCESS='AUTH_SUCCESS';export var AUTH_FAIL='AUTH_FAIL';export var AUTH_LOGOUT='AUTH_LOGOUT';export var AUTH_TOKEN='AUTH_TOKEN';export var AUTH_LOADING='AUTH_LOADING';/**************************************************************************\n * Se definen los actions\n */export var authStart=function authStart(){return{type:AUTH_START};};export var checkStateAuth=function checkStateAuth(){return{type:AUTH_LOADING};};export var authSuccess=function authSuccess(token,email,name,nick_name){return{type:AUTH_SUCCESS,token:token,email:email,name:name,nick_name:nick_name};};export var authFail=function authFail(error){return{type:AUTH_FAIL,error:error};};export var logout=function logout(){localStorage.removeItem('token');return{type:AUTH_LOGOUT};};export var auth=function auth(email,password){return function(dispatch){dispatch(authStart());var authData={email:email,password:password,returnSecureToken:true};axios({url:'api/auth/signin',method:'POST',data:authData}).then(function(response){dispatch(authSuccess(response.data.token,email,response.data.name,response.data.surname,response.data.picture));dispatch(updateToken(response.data.token));}).catch(function(err){dispatch(authFail(err));});};};export var authCheckState=function authCheckState(){return function(dispatch){dispatch(authStart());var token=localStorage.getItem('token');if(!token){dispatch(logout());}else{axios({url:'api/auth/verify',method:'POST',data:{token:token}}).then(function(response){dispatch(authSuccess(token,response.data.email,response.data.name,response.data.nick_name));dispatch(updateToken(token));}).catch(function(err){dispatch(authFail(err));});}};};export var updToken=function updToken(token){return{type:AUTH_TOKEN,token:token};};export var updateToken=function updateToken(token){return function(dispatch){localStorage.setItem('token',token);axios.defaults.headers.common['Authorization']=token;axios.defaults.headers.common.Authorization=token;dispatch(updToken(token));};};var updateLocalStorage=function updateLocalStorage(data){localStorage.setItem('email',data.email);localStorage.setItem('name',data.name);localStorage.setItem('nick_name',data.nick_name);};export var signin=function signin(userData){return function(dispatch){dispatch(authStart());axios({url:'api/auth/signin',method:'POST',data:userData}).then(function(response){dispatch(authSuccess(response.data.token,userData.email,response.data.name,response.data.surname,response.data.picture));dispatch(updateToken(response.data.token));}).catch(function(err){if(err){dispatch(authFail(err));}});};};export var signup=function signup(userData){return function(dispatch){dispatch(authStart());axios({url:'api/auth/signup',method:'POST',data:userData}).then(function(response){/*\n           dispatch(\n             authSuccess(\n               response.data.token,\n               userData.email,\n               userData.name,\n               userData.surname\n             )\n           );\n           */ //dispatch(updateToken(response.data.token));\n}).catch(function(err){if(err){;console.log('salto el medio error',err);dispatch(authFail(err));}});};};export var authLogoutSession=function authLogoutSession(){return{type:AUTH_LOGOUT};};export var authLogout=function authLogout(){return function(dispatch){localStorage.removeItem('token');delete axios.defaults.headers.common.Authorization;dispatch(authLogoutSession());};};export var authGoogle=function authGoogle(googleData){return function(dispatch){dispatch(authStart());axios({url:'api/auth/google',method:'POST',data:googleData}).then(function(response){if(response.data.message){dispatch(authFail(response.data.message));}else{dispatch(authSuccess(response.data.token,response.data.email,response.data.name,response.data.nick_name));//   updateLocalStorage(response.data)\ndispatch(updateToken(response.data.token));}}).catch(function(err){if(err){dispatch(authFail(err));}});};};export var authGoogleSignIN=function authGoogleSignIN(googleData){return function(dispatch){dispatch(authStart());axios({url:'api/auth/googleIn',method:'POST',data:googleData}).then(function(response){if(response.data.message){dispatch(authFail(response.data.message));}else{dispatch(authSuccess(response.data.token,response.data.email,response.data.name,response.data.nick_name));//  updateLocalStorage(response.data)\ndispatch(updateToken(response.data.token));}}).catch(function(err){if(err){dispatch(authFail(err));}});};};/**************************************************************************\n * Se definen los reducers\n */var reducerAuthStart=function reducerAuthStart(state,action){return updateObject(state,{error:null,loading:true});};var loadingLocalStorage=function loadingLocalStorage(state,action){return updateObject(state,{error:null,loading:true});};var reducerAuthSuccess=function reducerAuthSuccess(state,action){return updateObject(state,{token:action.token,email:action.email,name:action.name,surname:action.surname,picture:action.picture,nick_name:action.nick_name,error:null,loading:false});};var reducerAuthFail=function reducerAuthFail(state,action){;return updateObject(state,{error:action.error,loading:false});};var reducerAuthLogout=function reducerAuthLogout(state,action){return updateObject(state,{token:null,email:null,name:null,surname:null,picture:null});};var reducerUpdateToken=function reducerUpdateToken(state,action){return updateObject(state,{token:action.token});};/**************************************************************************\n * Core del reducer\n */export default function reducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{token:null,email:null,name:null,surname:null,picture:null,error:null,nick_name:null,loading:false};var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case AUTH_LOADING:return loadingLocalStorage(state,action);case AUTH_START:return reducerAuthStart(state,action);case AUTH_SUCCESS:return reducerAuthSuccess(state,action);case AUTH_FAIL:return reducerAuthFail(state,action);case AUTH_LOGOUT:return reducerAuthLogout(state,action);case AUTH_TOKEN:return reducerUpdateToken(state,action);default:break;}return state;}","map":{"version":3,"sources":["/home/sebastian/Escritorio/timezo/front/src/reducer/auth.js"],"names":["axios","updateObject","AUTH_START","AUTH_SUCCESS","AUTH_FAIL","AUTH_LOGOUT","AUTH_TOKEN","AUTH_LOADING","authStart","type","checkStateAuth","authSuccess","token","email","name","nick_name","authFail","error","logout","localStorage","removeItem","auth","password","dispatch","authData","returnSecureToken","url","method","data","then","response","surname","picture","updateToken","catch","err","authCheckState","getItem","updToken","setItem","defaults","headers","common","Authorization","updateLocalStorage","signin","userData","signup","console","log","authLogoutSession","authLogout","authGoogle","googleData","message","authGoogleSignIN","reducerAuthStart","state","action","loading","loadingLocalStorage","reducerAuthSuccess","reducerAuthFail","reducerAuthLogout","reducerUpdateToken","reducer"],"mappings":"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","sourcesContent":["import axios from '../utils/axios';\nimport updateObject from '../utils/updateObject';\n\n/**************************************************************************\n * Se definen los action types\n */\n\nexport const AUTH_START = 'AUTH_START';\nexport const AUTH_SUCCESS = 'AUTH_SUCCESS';\nexport const AUTH_FAIL = 'AUTH_FAIL';\nexport const AUTH_LOGOUT = 'AUTH_LOGOUT';\nexport const AUTH_TOKEN = 'AUTH_TOKEN';\nexport const AUTH_LOADING = 'AUTH_LOADING'\n\n/**************************************************************************\n * Se definen los actions\n */\n\nexport const authStart = () => {\n  return {\n    type: AUTH_START\n  };\n};\n\nexport const checkStateAuth = () => {\n  return {\n    type: AUTH_LOADING\n  };\n};\n\nexport const authSuccess = (token, email, name, nick_name) => {\n  return {\n    type: AUTH_SUCCESS,\n    token: token,\n    email,\n    name,\n    nick_name\n  };\n};\n\nexport const authFail = (error) => {\n  return {\n    type: AUTH_FAIL,\n    error: error\n  };\n};\n\nexport const logout = () => {\n  localStorage.removeItem('token');\n  return {\n    type: AUTH_LOGOUT\n  };\n};\n\nexport const auth = (email, password) => {\n  return (dispatch) => {\n    dispatch(authStart());\n    const authData = {\n      email: email,\n      password: password,\n      returnSecureToken: true\n    };\n    axios({\n      url: 'api/auth/signin',\n      method: 'POST',\n      data: authData\n    })\n      .then((response) => {\n        dispatch(\n          authSuccess(\n            response.data.token,\n            email,\n            response.data.name,\n            response.data.surname,\n            response.data.picture\n          )\n        );\n        dispatch(updateToken(response.data.token));\n      })\n      .catch((err) => {\n         \n        dispatch(authFail(err));\n      });\n  };\n};\n\nexport const authCheckState = () => {\n  return (dispatch) => {\n    dispatch(authStart());\n    const token = localStorage.getItem('token');\n    if (!token) {\n      dispatch(logout());\n    } else {\n      axios({\n        url: 'api/auth/verify',\n        method: 'POST',\n        data: { token }\n      })\n        .then((response) => {\n          dispatch(\n            authSuccess(\n              token,\n              response.data.email,\n              response.data.name,\n              response.data.nick_name,\n            )\n          );\n          dispatch(updateToken(token));\n        })\n        .catch((err) => {\n          dispatch(authFail(err));\n        });\n    }\n  };\n};\n\nexport const updToken = (token) => {\n  return {\n    type: AUTH_TOKEN,\n    token: token\n  };\n};\n\nexport const updateToken = (token) => {\n  return (dispatch) => {\n     \n    localStorage.setItem('token', token);\n    axios.defaults.headers.common['Authorization'] = token;\n    axios.defaults.headers.common.Authorization = token;\n    dispatch(updToken(token));\n  };\n};\n\n\n const updateLocalStorage = (data) => {\n    localStorage.setItem('email', data.email);\n    localStorage.setItem('name', data.name);\n    localStorage.setItem('nick_name', data.nick_name);\n};\n\nexport const signin = (userData) => {\n  return (dispatch) => {\n    dispatch(authStart());\n    axios({\n      url: 'api/auth/signin',\n      method: 'POST',\n      data: userData\n    })\n      .then((response) => {\n        dispatch(\n          authSuccess(\n            response.data.token,\n            userData.email,\n            response.data.name,\n            response.data.surname,\n            response.data.picture\n          )\n        );\n        dispatch(updateToken(response.data.token));\n      })\n      .catch((err) => {\n        if (err) {\n          dispatch(authFail(err));\n        }\n      });\n  };\n};\n\nexport const signup = (userData) => {\n  return (dispatch) => {\n    dispatch(authStart());\n    axios({\n      url: 'api/auth/signup',\n      method: 'POST',\n      data: userData\n    })\n      .then((response) => {\n        /*\n           dispatch(\n             authSuccess(\n               response.data.token,\n               userData.email,\n               userData.name,\n               userData.surname\n             )\n           );\n           */\n        //dispatch(updateToken(response.data.token));\n      })\n      .catch((err) => {\n        if (err) {\n           ;\n          console.log('salto el medio error', err)\n          dispatch(authFail(err));\n        }\n      });\n  };\n};\n\nexport const authLogoutSession = () => {\n  return {\n    type: AUTH_LOGOUT\n  };\n};\n\nexport const authLogout = () => {\n  return (dispatch) => {\n    localStorage.removeItem('token');\n    delete axios.defaults.headers.common.Authorization;\n    dispatch(authLogoutSession());\n  };\n};\n\nexport const authGoogle = (googleData) => {\n  return (dispatch) => {\n    dispatch(authStart());\n    axios({\n      url: 'api/auth/google',\n      method: 'POST',\n      data: googleData\n    })\n      .then((response) => {\n        if (response.data.message) {\n          dispatch(authFail(response.data.message));\n        } else {\n          dispatch(\n            authSuccess(\n              response.data.token,\n              response.data.email,\n              response.data.name,\n              response.data.nick_name,\n            )\n          );\n       //   updateLocalStorage(response.data)\n          dispatch(updateToken(response.data.token));\n        }\n      })\n      .catch((err) => {\n        if (err) {\n          dispatch(authFail(err));\n        }\n      });\n  };\n};\n\nexport const authGoogleSignIN = (googleData) => {\n  return (dispatch) => {\n    dispatch(authStart());\n    axios({\n      url: 'api/auth/googleIn',\n      method: 'POST',\n      data: googleData\n    })\n      .then((response) => {\n        if (response.data.message) {\n          dispatch(authFail(response.data.message));\n        } else {\n          dispatch(\n            authSuccess(\n              response.data.token,\n              response.data.email,\n              response.data.name,\n              response.data.nick_name,\n            )\n          );\n        //  updateLocalStorage(response.data)\n          dispatch(updateToken(response.data.token));\n        }\n\n      })\n      .catch((err) => {\n        if (err) {\n          dispatch(authFail(err));\n        }\n      });\n  };\n};\n\n/**************************************************************************\n * Se definen los reducers\n */\n\nconst reducerAuthStart = (state, action) => {\n  return updateObject(state, { error: null, loading: true });\n};\n\nconst loadingLocalStorage = (state, action) => {\n  return updateObject(state, { error: null, loading: true });\n};\n\n\nconst reducerAuthSuccess = (state, action) => {\n  return updateObject(state, {\n    token: action.token,\n    email: action.email,\n    name: action.name,\n    surname: action.surname,\n    picture: action.picture,\n    nick_name: action.nick_name,\n    error: null,\n    loading: false\n  });\n};\n\nconst reducerAuthFail = (state, action) => {\n   ;\n  return updateObject(state, {\n    error: action.error,\n    loading: false\n  });\n};\n\nconst reducerAuthLogout = (state, action) => {\n  return updateObject(state, {\n    token: null,\n    email: null,\n    name: null,\n    surname: null,\n    picture: null\n  });\n};\n\nconst reducerUpdateToken = (state, action) => {\n  return updateObject(state, {\n    token: action.token\n  });\n};\n\n/**************************************************************************\n * Core del reducer\n */\n\nexport default function reducer(\n  state = {\n    token: null,\n    email: null,\n    name: null,\n    surname: null,\n    picture: null,\n    error: null,\n    nick_name: null,\n    loading: false\n  },\n  action\n) {\n  switch (action.type) {\n    case AUTH_LOADING:\n      return loadingLocalStorage(state, action);\n    case AUTH_START:\n      return reducerAuthStart(state, action);\n    case AUTH_SUCCESS:\n      return reducerAuthSuccess(state, action);\n    case AUTH_FAIL:\n      return reducerAuthFail(state, action);\n    case AUTH_LOGOUT:\n      return reducerAuthLogout(state, action);\n    case AUTH_TOKEN:\n      return reducerUpdateToken(state, action);\n    default:\n      break;\n  }\n  return state;\n}"]},"metadata":{},"sourceType":"module"}