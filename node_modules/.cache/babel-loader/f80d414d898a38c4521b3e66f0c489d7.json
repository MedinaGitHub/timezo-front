{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _regeneratorRuntime from\"/home/sebastian/Escritorio/timezo/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/sebastian/Escritorio/timezo/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/sebastian/Escritorio/timezo/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{Component,useEffect,useState}from'react';import{google,outlook,office365,yahoo,ics}from\"calendar-link\";import Bowser from\"bowser\";var Calendars=function Calendars(_ref){var name=_ref.name,timeTZ=_ref.timeTZ,timeLocal=_ref.timeLocal;var _useState=useState(),_useState2=_slicedToArray(_useState,2),browser=_useState2[0],setBrowser=_useState2[1];var bowseer=Bowser.getParser(window.navigator.userAgent);var event={title:name,start:timeTZ};var openCalendar=function openCalendar(link){window.open(link,\"_blank\");};var sw=navigator.serviceWorker;function pad(num){var size=arguments.length>1&&arguments[1]!==undefined?arguments[1]:2;var s=num+'';while(s.length<size){s='0'+s;}return s;}function toTimestamp(strDate){var datum=Date.parse(strDate);return datum/1000;}useEffect(function(){console.log(1);console.log('sw',sw);if(sw&&browser==true){console.log(2);/*global showNotification, TimestampTrigger*/ /*eslint no-undef: \"error\"*/var requestServices=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var reg;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(\"showTrigger\"in Notification.prototype){/* Notification Triggers supported */console.log('Notification Triggers supported');};_context.next=4;return sw.getRegistration();case 4:reg=_context.sent;console.log('timeTZ',timeTZ);Notification.requestPermission().then(function(permission){if(permission!=='granted'){alert('you need to allow push notifications');}else{//const timestamp = new Date().getTime() + 10 * 1000;\nvar timestamp=new Date(timeTZ).getTime();console.log('timeTZ',timeTZ);console.log('timestap que le pego',new Date(timeTZ).getTime());console.log(new Date().getTime());console.log('new Date(eventTZ)',toTimestamp(timeTZ));//timestamp || Calcular cuanto falta de aquí a que termine el evento.\nvar scheduledTime=new Date(timestamp);console.log('timeLocal',timeLocal);console.log(bowseer.getBrowser());if(bowseer.getBrowser().name==\"Chrome\"){//TODO: REVIEW VERSION > 80\nreg.showNotification('Scheduled Push Notification',{tag:timestamp,// a unique ID\nbody:'El evento '+name+' Comienza en 5 minutos !',// content of the push notification\nshowTrigger:new TimestampTrigger(timestamp),// set the time for the push notification\ndata:{url:window.location.href// pass the current url to the notification\n}});}else{reg.showNotification('Scheduled Push Notification',{tag:timestamp,// a unique ID\nbody:'El evento '+name+' Comienza en 5 minutos !',// content of the push notification\ntimestamp:timestamp,// set the time for the push notification\ndata:{url:window.location.href// pass the current url to the notification\n}});}}});case 7:case\"end\":return _context.stop();}}},_callee);}));return function requestServices(){return _ref2.apply(this,arguments);};}();requestServices();}},[sw,browser]);return/*#__PURE__*/_jsxs(\"div\",{className:\"calendars\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Tambi\\xE9n, recuerdame\"}),/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsxs(\"li\",{style:{cursor:'pointer'},onClick:function onClick(){return openCalendar(google(event));},children:[/*#__PURE__*/_jsx(\"div\",{className:\"ic google\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"info\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Calendar\"}),/*#__PURE__*/_jsx(\"h4\",{children:\"Google\"})]})]}),/*#__PURE__*/_jsxs(\"li\",{style:{cursor:'pointer'},onClick:function onClick(){return openCalendar(ics(event));},children:[/*#__PURE__*/_jsx(\"div\",{className:\"ic apple\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"info\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Calendar\"}),/*#__PURE__*/_jsx(\"h4\",{children:\"Apple\"})]})]}),/*#__PURE__*/_jsxs(\"li\",{style:{cursor:'pointer'},onClick:function onClick(){return openCalendar(outlook(event));},children:[/*#__PURE__*/_jsx(\"div\",{className:\"ic outlook\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"info\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Calendar\"}),/*#__PURE__*/_jsx(\"h4\",{children:\"Outlook\"})]})]})]}),bowseer.getBrowser().name==\"Chrome\"&&/*#__PURE__*/_jsxs(\"div\",{className:\"browser\",onClick:function onClick(){return setBrowser(true);},children:[/*#__PURE__*/_jsx(\"p\",{style:{cursor:'pointer'},children:\"Nah! prefiero en mi navegador\"}),/*#__PURE__*/_jsx(\"div\",{style:{cursor:'pointer'},className:\"ic chrome\"})]})]});};export{Calendars};","map":{"version":3,"sources":["/home/sebastian/Escritorio/timezo/front/src/pages/ReadEvent/Calendars.js"],"names":["React","Component","useEffect","useState","google","outlook","office365","yahoo","ics","Bowser","Calendars","name","timeTZ","timeLocal","browser","setBrowser","bowseer","getParser","window","navigator","userAgent","event","title","start","openCalendar","link","open","sw","serviceWorker","pad","num","size","s","length","toTimestamp","strDate","datum","Date","parse","console","log","requestServices","Notification","prototype","getRegistration","reg","requestPermission","then","permission","alert","timestamp","getTime","scheduledTime","getBrowser","showNotification","tag","body","showTrigger","TimestampTrigger","data","url","location","href","cursor"],"mappings":"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","sourcesContent":["import React, { Component, useEffect, useState } from 'react'\nimport { google, outlook, office365, yahoo, ics } from \"calendar-link\";\nimport Bowser from \"bowser\";\n\n\nconst Calendars = ({ name, timeTZ, timeLocal }) => {\n\n    const [browser, setBrowser] = useState()\n    const bowseer = Bowser.getParser(window.navigator.userAgent);\n\n    const event = {\n        title: name,\n        start: timeTZ\n    };\n\n    const openCalendar = (link) => {\n        window.open(link, \"_blank\")\n    }\n    const sw = navigator.serviceWorker;\n\n    function pad(num, size = 2) {\n        let s = num + '';\n        while (s.length < size) s = '0' + s;\n        return s;\n    }\n\n    function toTimestamp(strDate){\n        var datum = Date.parse(strDate);\n        return datum/1000;\n     }\n\n    useEffect(() => {\n        console.log(1)\n        console.log('sw', sw)\n        if (sw && browser == true) {\n            console.log(2)\n            /*global showNotification, TimestampTrigger*/\n            /*eslint no-undef: \"error\"*/\n            const requestServices = async () => {\n                 \n\n                if (\"showTrigger\" in Notification.prototype) {\n                    /* Notification Triggers supported */\n                    console.log('Notification Triggers supported')\n                }\n                 ;\n                const reg = await sw.getRegistration();\n                console.log('timeTZ',timeTZ)\n\n\n                Notification.requestPermission().then(permission => {\n                    if (permission !== 'granted') {\n                        alert('you need to allow push notifications');\n                    } else {\n                        //const timestamp = new Date().getTime() + 10 * 1000;\n                        const timestamp  =   new Date(timeTZ).getTime() \n                        console.log('timeTZ',timeTZ)\n                        console.log('timestap que le pego', new Date(timeTZ).getTime() )\n\n                        console.log(new Date().getTime())\n\n                        console.log('new Date(eventTZ)',toTimestamp(timeTZ) )\n                        //timestamp || Calcular cuanto falta de aquí a que termine el evento.\n                        const scheduledTime = new Date(timestamp);\n                        console.log('timeLocal', timeLocal)\n\n\n                        console.log(bowseer.getBrowser());\n\n                        if (bowseer.getBrowser().name == \"Chrome\") { //TODO: REVIEW VERSION > 80\n                            reg.showNotification(\n                                'Scheduled Push Notification',\n                                {\n                                    tag: timestamp, // a unique ID\n                                    body: 'El evento '+name+' Comienza en 5 minutos !', // content of the push notification\n                                    showTrigger: new TimestampTrigger(timestamp), // set the time for the push notification\n                                    data: {\n                                        url: window.location.href, // pass the current url to the notification\n                                    }\n                                }\n                            );\n                        } else {\n                            reg.showNotification(\n                                'Scheduled Push Notification',\n                                {\n                                    tag: timestamp, // a unique ID\n                                    body: 'El evento '+name+' Comienza en 5 minutos !', // content of the push notification\n                                    timestamp: timestamp, // set the time for the push notification\n                                    data: {\n                                        url: window.location.href, // pass the current url to the notification\n                                    }\n                                }\n                            );\n                        }\n                    }\n                });\n\n\n            }\n            requestServices();\n\n        }\n    }, [sw, browser])\n\n    return (\n        <div className=\"calendars\">\n            <p>También, recuerdame</p>\n            <ul>\n                <li style={{cursor:'pointer'}} onClick={() => openCalendar(google(event))}>\n                    <div className=\"ic google\"></div>\n                    <div className=\"info\">\n                        <span>Calendar</span>\n                        <h4>Google</h4>\n                    </div>\n                </li>\n                <li style={{cursor:'pointer'}}  onClick={() => openCalendar(ics(event))}>\n                    <div className=\"ic apple\"></div>\n                    <div className=\"info\">\n                        <span>Calendar</span>\n                        <h4>Apple</h4>\n                    </div>\n                </li>\n                <li style={{cursor:'pointer'}}  onClick={() => openCalendar(outlook(event))}>\n                    <div className=\"ic outlook\"></div>\n                    <div className=\"info\">\n                        <span>Calendar</span>\n                        <h4>Outlook</h4>\n                    </div>\n                </li>\n            </ul>\n\n            { bowseer.getBrowser().name == \"Chrome\" && <div className=\"browser\" onClick={() => setBrowser(true)}>\n                <p style={{cursor:'pointer'}} >Nah! prefiero en mi navegador</p>\n                <div style={{cursor:'pointer'}}  className=\"ic chrome\"></div>\n            </div>}\n\n\n            {/*\n              <p className=\"cright\">Lorem ipsum dolor, sit amet consectetur adipisicing elit. Fugit a ipsum quod eveniet excepturi.</p>\n            */}\n        </div>\n    )\n}\n\nexport { Calendars }"]},"metadata":{},"sourceType":"module"}