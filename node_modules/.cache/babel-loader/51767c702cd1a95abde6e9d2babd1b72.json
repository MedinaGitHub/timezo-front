{"ast":null,"code":"import _toConsumableArray from\"/home/sebastian/Escritorio/timezo/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import _regeneratorRuntime from\"/home/sebastian/Escritorio/timezo/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/sebastian/Escritorio/timezo/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"/home/sebastian/Escritorio/timezo/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _slicedToArray from\"/home/sebastian/Escritorio/timezo/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectSpread from\"/home/sebastian/Escritorio/timezo/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{jsx as _jsx}from\"react/jsx-runtime\";import React,{Fragment,useState,useRef,useEffect}from'react';import{withStyles}from'@material-ui/core/styles';import{useForm}from'react-hook-form';import DateFnsUtils from'@date-io/date-fns';import{DateTimePicker,KeyboardDateTimePicker,MuiPickersUtilsProvider}from\"@material-ui/pickers\";import axios from'../../utils/axios';import Chip from'@material-ui/core/Chip';import Autocomplete from'@material-ui/lab/Autocomplete';import{makeStyles}from'@material-ui/core/styles';import TextField from'@material-ui/core/TextField';import es from\"date-fns/locale/es\";import{words}from'../../utils/words';import ReCAPTCHA from\"react-google-recaptcha\";import{useSelector,useDispatch}from'react-redux';import{useHistory}from\"react-router-dom\";//check boxes form.\nimport FormLabel from'@material-ui/core/FormLabel';import FormControl from'@material-ui/core/FormControl';import FormGroup from'@material-ui/core/FormGroup';import FormControlLabel from'@material-ui/core/FormControlLabel';import FormHelperText from'@material-ui/core/FormHelperText';import Checkbox from'@material-ui/core/Checkbox';var PurpleCheckbox=withStyles({root:{color:\"#8266E2\",'&$checked':{color:\"#8266E2\"}},checked:{}})(function(props){return/*#__PURE__*/_jsx(Checkbox,_objectSpread({color:\"default\"},props));});var Form=function Form(_ref){var openModalSet=_ref.openModalSet;var _useForm=useForm(),register=_useForm.register,errors=_useForm.errors,handleSubmit=_useForm.handleSubmit;var history=useHistory();var auth=useSelector(function(_ref2){var auth=_ref2.auth;return auth;});var _React$useState=React.useState([]),_React$useState2=_slicedToArray(_React$useState,2),valueAutocomplete=_React$useState2[0],setValueAutocomplete=_React$useState2[1];var _useState=useState(null),_useState2=_slicedToArray(_useState,2),selectedDate=_useState2[0],handleDateChange=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),captcha=_useState4[0],setCaptcha=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),link=_useState6[0],setlink=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),error=_useState8[0],setError=_useState8[1];var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),bodyFormData=_useState10[0],setBodyFormData=_useState10[1];var _useState11=useState('Crear'),_useState12=_slicedToArray(_useState11,2),loading=_useState12[0],setLoading=_useState12[1];var reRef=useRef();var _React$useState3=React.useState({createAccount:false}),_React$useState4=_slicedToArray(_React$useState3,2),checkBoxes=_React$useState4[0],setCheckBoxes=_React$useState4[1];var handleChangeChecks=function handleChangeChecks(event){setCheckBoxes(_objectSpread(_objectSpread({},checkBoxes),{},_defineProperty({},event.target.name,event.target.checked)));};var sendDataToServer=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!bodyFormData){_context.next=12;break;}if(!auth.token){_context.next=7;break;}_context.next=4;return axios.post('api/createAuth',bodyFormData,{headers:{'Content-Type':'multipart/form-data','Authorization':auth.token}});case 4:response=_context.sent;_context.next=10;break;case 7:_context.next=9;return axios.post('api/create',bodyFormData,{headers:{'Content-Type':'multipart/form-data'}});case 9:response=_context.sent;case 10:setLoading('Crear');if(response.data.message){setError(response.data.message);}else{history.push(\"/\"+response.data._nick_name+'/'+response.data.id);}case 12:case\"end\":return _context.stop();}}},_callee);}));return function sendDataToServer(){return _ref3.apply(this,arguments);};}();useEffect(function(){if(bodyFormData){if(checkBoxes.createAccount==false){sendDataToServer();}else if(checkBoxes.createAccount==true&&auth.token){sendDataToServer();}else{//ejecutar el modal de registro.\nopenModalSet(true);}}},[bodyFormData,auth.token]);useEffect(function(){if(bodyFormData){if(checkBoxes.createAccount==false){sendDataToServer();}else if(checkBoxes.createAccount==true&&auth.token){sendDataToServer();}else{//ejecutar el modal de registro.\nopenModalSet(true);}}},[auth.token]);var onSubmit=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(data,e){var token_recaptcha,bodyFormData;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setError(null);setLoading('Cargando...');if(captcha){_context2.next=7;break;}_context2.next=5;return reRef.current.executeAsync();case 5:token_recaptcha=_context2.sent;setCaptcha(token_recaptcha);case 7:bodyFormData=new FormData();bodyFormData.append('token_recaptcha',captcha);bodyFormData.append('_name',data._name);bodyFormData.append('_description',data._description);bodyFormData.append('_categories',JSON.stringify(valueAutocomplete));bodyFormData.append('_event_time',selectedDate);bodyFormData.append('_link_event',data._link_event);bodyFormData.append('galleryImage',data._picture[0]);setBodyFormData(bodyFormData);// ejecuta el useEffect\ncase 16:case\"end\":return _context2.stop();}}},_callee2);}));return function onSubmit(_x,_x2){return _ref4.apply(this,arguments);};}();function showExtra(){var element=document.getElementById(\"extra\");var btn=document.getElementById(\"btnExtra\");element.classList.add(\"show\");btn.classList.add(\"hide\");}return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(\"form\",{onSubmit:handleSubmit(onSubmit),children:/*#__PURE__*/_jsxs(\"div\",{className:\"form__event\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"cont__form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form--input\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",autocomplete:\"off\",className:\"normal\",placeholder:\"Nombre Evento\",minlength:\"2\",maxlength:\"150\",required:true,name:\"_name\",ref:register({required:{value:true,message:'Ingrese el nombre del evento'}})}),/*#__PURE__*/_jsx(\"span\",{children:\"Nombre Evento\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form--input optional\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",autocomplete:\"off\",className:\"normal\",placeholder:\"Descripci\\xF3n\",minlength:\"0\",maxlength:\"1000\",name:\"_description\",ref:register({required:{value:true,message:'Ingrese la descripción del evento'}})}),/*#__PURE__*/_jsx(\"span\",{children:\"Descripci\\xF3n\"}),/*#__PURE__*/_jsx(\"h5\",{children:\"opcional\"})]}),/*#__PURE__*/_jsx(Autocomplete,{name:\"_categories\",multiple:true,id:\"tags-filled\",value:valueAutocomplete,options:words.map(function(option){return option;}),freeSolo:true,renderTags:function renderTags(value,getTagProps){return value.map(function(option,index){return/*#__PURE__*/_jsx(Chip,_objectSpread({variant:\"outlined\",label:option},getTagProps({index:index})));});},onChange:function onChange(event,newValue){setValueAutocomplete(_toConsumableArray(newValue));},renderInput:function renderInput(params){return/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},params),{},{label:\"Categor\\xEDas\",placeholder:\"Categoria\"}));}}),/*#__PURE__*/_jsxs(\"div\",{className:\"form--input half border picture\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"file-4\",className:\"normal inputfile inputfile-3\",\"data-multiple-caption\":\"{count} files selected\",accept:\".jpg, .jpeg, .png, .gif\",placeholder:\"Imagen\",name:\"_picture\",ref:register({required:{value:true,message:'Ingrese la imágen del evento'}}),required:true}),/*#__PURE__*/_jsx(\"label\",{for:\"file-4\",children:/*#__PURE__*/_jsx(\"h6\",{children:\"Imagen\"})}),/*#__PURE__*/_jsx(\"span\",{children:\"Imagen\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"form--input half border date\",children:/*#__PURE__*/_jsx(MuiPickersUtilsProvider,{utils:DateFnsUtils,locale:es,children:/*#__PURE__*/_jsx(DateTimePicker,{className:\"seba\",ampm:false,value:selectedDate,onChange:handleDateChange,label:\"Fecha & Hora\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"form--input\",children:[/*#__PURE__*/_jsx(\"input\",{autocomplete:\"off\",name:\"_link_event\",type:\"text\",className:\"normal\",placeholder:\"Link Evento\",ref:register({required:{value:true,message:'Ingrese la imágen del evento'}}),required:true}),/*#__PURE__*/_jsx(\"span\",{children:\"Link evento\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bottom__form\",children:/*#__PURE__*/_jsx(FormControlLabel,{control:/*#__PURE__*/_jsx(PurpleCheckbox,{checked:checkBoxes.createAccount,onChange:handleChangeChecks,name:\"createAccount\"}),label:\"Quiero registrarme para gestionar mis eventos\"})}),/*#__PURE__*/_jsxs(\"button\",{type:\"submit\",className:\"btn--create\",children:[loading,\"!\"]})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"div-link\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"error_create_event\",children:[error,\" \"]})}),link&&/*#__PURE__*/_jsx(\"div\",{className:\"div-link\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"link_finally\",children:[\" Tu link \\uD83D\\uDC49\\uD83C\\uDFFB \",/*#__PURE__*/_jsx(\"a\",{target:\"_blank\",href:\"\".concat(link),children:link}),\" \"]})})]})}),/*#__PURE__*/_jsx(ReCAPTCHA,{sitekey:process.env.REACT_APP_RECAPTCHA,ref:reRef,size:\"invisible\"})]});};export default Form;","map":{"version":3,"sources":["/home/sebastian/Escritorio/timezo/front/src/pages/CreateEvent/Form.js"],"names":["React","Fragment","useState","useRef","useEffect","withStyles","useForm","DateFnsUtils","DateTimePicker","KeyboardDateTimePicker","MuiPickersUtilsProvider","axios","Chip","Autocomplete","makeStyles","TextField","es","words","ReCAPTCHA","useSelector","useDispatch","useHistory","FormLabel","FormControl","FormGroup","FormControlLabel","FormHelperText","Checkbox","PurpleCheckbox","root","color","checked","props","Form","openModalSet","register","errors","handleSubmit","history","auth","valueAutocomplete","setValueAutocomplete","selectedDate","handleDateChange","captcha","setCaptcha","link","setlink","error","setError","bodyFormData","setBodyFormData","loading","setLoading","reRef","createAccount","checkBoxes","setCheckBoxes","handleChangeChecks","event","target","name","sendDataToServer","token","post","headers","response","data","message","push","_nick_name","id","onSubmit","e","current","executeAsync","token_recaptcha","FormData","append","_name","_description","JSON","stringify","_link_event","_picture","showExtra","element","document","getElementById","btn","classList","add","required","value","map","option","getTagProps","index","newValue","params","process","env","REACT_APP_RECAPTCHA"],"mappings":"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","sourcesContent":["import React, { Fragment, useState, useRef, useEffect } from 'react'\nimport { withStyles } from '@material-ui/core/styles';\nimport { useForm } from 'react-hook-form'\nimport DateFnsUtils from '@date-io/date-fns';\nimport { DateTimePicker, KeyboardDateTimePicker, MuiPickersUtilsProvider } from \"@material-ui/pickers\";\nimport axios from '../../utils/axios';\nimport Chip from '@material-ui/core/Chip';\nimport Autocomplete from '@material-ui/lab/Autocomplete';\nimport { makeStyles } from '@material-ui/core/styles';\nimport TextField from '@material-ui/core/TextField';\nimport es from \"date-fns/locale/es\";\nimport { words } from '../../utils/words'\nimport ReCAPTCHA from \"react-google-recaptcha\";\nimport { useSelector, useDispatch } from 'react-redux';\nimport { useHistory } from \"react-router-dom\";\n//check boxes form.\nimport FormLabel from '@material-ui/core/FormLabel';\nimport FormControl from '@material-ui/core/FormControl';\nimport FormGroup from '@material-ui/core/FormGroup';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport FormHelperText from '@material-ui/core/FormHelperText';\nimport Checkbox from '@material-ui/core/Checkbox';\n\nconst PurpleCheckbox = withStyles({\n    root: {\n        color: \"#8266E2\",\n        '&$checked': {\n            color: \"#8266E2\",\n        },\n    },\n    checked: {},\n})((props) => <Checkbox color=\"default\" {...props} />);\n\n\nconst Form = ({ openModalSet }) => {\n    const { register, errors, handleSubmit } = useForm();\n\n    const history = useHistory();\n    const auth = useSelector(({ auth }) => auth);\n    const [valueAutocomplete, setValueAutocomplete] = React.useState([]);\n    const [selectedDate, handleDateChange] = useState(null);\n    const [captcha, setCaptcha] = useState(null);\n    const [link, setlink] = useState()\n    const [error, setError] = useState()\n    const [bodyFormData, setBodyFormData] = useState()\n    const [loading, setLoading] = useState('Crear')\n    const reRef = useRef();\n\n    const [checkBoxes, setCheckBoxes] = React.useState({\n        createAccount: false,\n    });\n\n    const handleChangeChecks = (event) => {\n        setCheckBoxes({ ...checkBoxes, [event.target.name]: event.target.checked });\n    };\n\n    const sendDataToServer = async () => {\n        if (bodyFormData) {\n            var response;\n            if (auth.token) {\n                response = await axios.post('api/createAuth', bodyFormData, { headers: { 'Content-Type': 'multipart/form-data', 'Authorization': auth.token } });\n            } else {\n                response = await axios.post('api/create', bodyFormData, { headers: { 'Content-Type': 'multipart/form-data' } });\n            }\n            setLoading('Crear')\n            if (response.data.message) {\n                setError(response.data.message)\n            } else {\n                history.push(\"/\" + response.data._nick_name + '/' + response.data.id);\n            }\n        }\n    }\n\n    useEffect(() => {\n        if (bodyFormData) {\n            if (checkBoxes.createAccount == false) {\n                sendDataToServer()\n            } else if (checkBoxes.createAccount == true && auth.token) {\n                sendDataToServer()\n            } else {\n                //ejecutar el modal de registro.\n                openModalSet(true);\n            }\n        }\n    }, [bodyFormData, auth.token])\n\n    useEffect(() => {\n        if (bodyFormData) {\n            if (checkBoxes.createAccount == false) {\n                sendDataToServer()\n            } else if (checkBoxes.createAccount == true && auth.token) {\n                sendDataToServer()\n            } else {\n                //ejecutar el modal de registro.\n                openModalSet(true);\n            }\n        }\n    }, [auth.token])\n\n\n    const onSubmit = async (data, e) => {\n        setError(null)\n        setLoading('Cargando...')\n        if(!captcha){\n            const token_recaptcha = await reRef.current.executeAsync();\n            setCaptcha(token_recaptcha)\n        }\n        var bodyFormData = new FormData();\n        bodyFormData.append('token_recaptcha', captcha);\n        bodyFormData.append('_name', data._name);\n        bodyFormData.append('_description', data._description);\n        bodyFormData.append('_categories', JSON.stringify(valueAutocomplete));\n        bodyFormData.append('_event_time', selectedDate);\n        bodyFormData.append('_link_event', data._link_event);\n        bodyFormData.append('galleryImage', data._picture[0]);\n        setBodyFormData(bodyFormData)// ejecuta el useEffect\n\n    }\n\n\n    function showExtra() {\n        var element = document.getElementById(\"extra\");\n        var btn = document.getElementById(\"btnExtra\");\n        element.classList.add(\"show\");\n        btn.classList.add(\"hide\");\n    }\n\n    return (\n        <Fragment>\n            <form onSubmit={handleSubmit(onSubmit)}>\n                <div className=\"form__event\">\n                    <div className=\"cont__form\">\n                        <div className=\"form--input\">\n                            <input type=\"text\" autocomplete=\"off\" className=\"normal\" placeholder=\"Nombre Evento\" minlength=\"2\" maxlength=\"150\" required\n                                name=\"_name\"\n                                ref={\n                                    register({\n                                        required: { value: true, message: 'Ingrese el nombre del evento' }\n                                    })}\n                            />\n                            <span>Nombre Evento</span>\n                        </div>\n\n                        <div className=\"form--input optional\">\n                            <input type=\"text\" autocomplete=\"off\" className=\"normal\" placeholder=\"Descripción\" minlength=\"0\" maxlength=\"1000\"\n                                name=\"_description\"\n                                ref={\n                                    register({\n                                        required: { value: true, message: 'Ingrese la descripción del evento' }\n                                    })}\n                            />\n                            <span>Descripción</span>\n                            <h5>opcional</h5>\n                        </div>\n\n                        {/*<input type=\"text\" className=\"normal\" placeholder=\"Categorías\" />*/}\n\n                        <Autocomplete\n                            name=\"_categories\"\n                            multiple\n                            id=\"tags-filled\"\n                            value={valueAutocomplete}\n                            options={words.map((option) => option)}\n                            freeSolo\n                            renderTags={(value, getTagProps) =>\n                                value.map((option, index) => (\n                                    <Chip variant=\"outlined\" label={option} {...getTagProps({ index })} />\n                                ))\n                            }\n                            onChange={(event, newValue) => {\n                                setValueAutocomplete([...newValue])\n\n                            }}\n                            renderInput={(params) => (\n                                <TextField {...params} label=\"Categorías\" placeholder=\"Categoria\" />\n                            )}\n                        />\n\n                        <div className=\"form--input half border picture\">\n                            <input type=\"file\"\n                                id=\"file-4\"\n                                className=\"normal inputfile inputfile-3\"\n                                data-multiple-caption=\"{count} files selected\"\n                                accept=\".jpg, .jpeg, .png, .gif\"\n                                placeholder=\"Imagen\"\n                                name=\"_picture\"\n                                ref={\n                                    register({\n                                        required: { value: true, message: 'Ingrese la imágen del evento' }\n                                    })}\n                                required />\n                            <label for=\"file-4\">\n                                <h6>Imagen</h6>\n                            </label>\n                            <span>Imagen</span>\n                        </div>\n\n                        <div className=\"form--input half border date\">\n                            <MuiPickersUtilsProvider utils={DateFnsUtils} locale={es}>\n                                <DateTimePicker\n                                    className=\"seba\"\n                                    ampm={false}\n                                    value={selectedDate}\n                                    onChange={handleDateChange}\n                                    label=\"Fecha & Hora\"\n                                />\n                            </MuiPickersUtilsProvider>\n                        </div>\n\n                        <div className=\"form--input\">\n                            <input autocomplete=\"off\" name=\"_link_event\" type=\"text\" className=\"normal\" placeholder=\"Link Evento\"\n                                ref={\n                                    register({\n                                        required: { value: true, message: 'Ingrese la imágen del evento' }\n                                    })}\n                                required />\n                            <span>Link evento</span>\n                        </div>\n\n                        <div className=\"bottom__form\">\n\n                            <FormControlLabel\n                                control={\n                                    <PurpleCheckbox\n                                        checked={checkBoxes.createAccount}\n                                        onChange={handleChangeChecks} name=\"createAccount\"\n                                    />\n                                }\n                                label=\"Quiero registrarme para gestionar mis eventos\"\n                            />\n\n                            {/* \n                                <div class=\"opt\" onClick={() => showExtra()} id=\"btnExtra\">Opciones avanzadas</div>\n\n                                    <div class=\"extra\" id=\"extra\">\n                                        <div class=\"form--check\">\n                                            <label for=\"caca\">Lorem ipsum dolor sit amet</label>\n                                            <input type=\"checkbox\" id=\"caca\" checked />\n                                            <span></span>\n                                        </div>\n\n                                        <div class=\"form--check\">\n                                            <label for=\"caca\">Consectetur adipisicing elit</label>\n                                            <input type=\"checkbox\" id=\"caca\" checked />\n                                            <span></span>\n                                        </div>\n                                        <div class=\"form--check\">\n                                            <label for=\"caca\">Laboriosam eaque ducimus eum autem</label>\n                                            <input type=\"checkbox\" id=\"caca\" checked />\n                                            <span></span>\n                                        </div>\n                                    </div>\n                            */}\n\n\n                        </div>\n                        <button type=\"submit\" className=\"btn--create\">{loading}!</button>\n\n                    </div>\n\n                    {error &&\n                        <div className=\"div-link\">\n                            <p className=\"error_create_event\">{error} </p>\n                        </div>\n                    }\n\n                    {link &&\n                        <div className=\"div-link\">\n                            <p className=\"link_finally\"> Tu link 👉🏻 <a target=\"_blank\" href={`${link}`} >{link}</a> </p>\n                        </div>\n                    }\n                </div>\n            </form>\n\n            <ReCAPTCHA\n                sitekey={process.env.REACT_APP_RECAPTCHA}\n                ref={reRef}\n                size=\"invisible\"\n            />\n        </Fragment >\n    )\n}\n\nexport default Form;"]},"metadata":{},"sourceType":"module"}