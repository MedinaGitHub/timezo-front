{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ics = exports.yahoo = exports.office365 = exports.outlook = exports.google = exports.eventify = void 0;\n\nconst dayjs_1 = __importDefault(require(\"dayjs\"));\n\nconst utc_1 = __importDefault(require(\"dayjs/plugin/utc\"));\n\nconst query_string_1 = require(\"query-string\");\n\nconst utils_1 = require(\"./utils\");\n\ndayjs_1.default.extend(utc_1.default);\n\nfunction formatTimes({\n  allDay,\n  startUtc,\n  endUtc\n}, dateTimeFormat) {\n  const format = utils_1.TimeFormats[allDay ? \"allDay\" : dateTimeFormat];\n  return {\n    start: startUtc.format(format),\n    end: endUtc.format(format)\n  };\n}\n\nconst eventify = event => {\n  const {\n    start,\n    end,\n    duration,\n    ...rest\n  } = event;\n  const startUtc = dayjs_1.default(start).utc();\n  const endUtc = end ? dayjs_1.default(end).utc() : (() => {\n    if (event.allDay) {\n      return startUtc.add(1, \"day\");\n    }\n\n    if (duration && duration.length == 2) {\n      const value = Number(duration[0]);\n      const unit = duration[1];\n      return startUtc.add(value, unit);\n    }\n\n    return dayjs_1.default().utc();\n  })();\n  return { ...rest,\n    startUtc,\n    endUtc\n  };\n};\n\nexports.eventify = eventify;\n\nconst google = calendarEvent => {\n  const event = exports.eventify(calendarEvent);\n  const {\n    start,\n    end\n  } = formatTimes(event, \"dateTimeUTC\");\n  const details = {\n    action: \"TEMPLATE\",\n    text: event.title,\n    details: event.description,\n    location: event.location,\n    trp: event.busy,\n    dates: start + \"/\" + end\n  };\n\n  if (event.guests && event.guests.length) {\n    details.add = event.guests.join();\n  }\n\n  return `https://calendar.google.com/calendar/render?${query_string_1.stringify(details)}`;\n};\n\nexports.google = google;\n\nconst outlook = calendarEvent => {\n  const event = exports.eventify(calendarEvent);\n  const {\n    start,\n    end\n  } = formatTimes(event, \"dateTimeWithOffset\");\n  const details = {\n    path: \"/calendar/action/compose\",\n    rru: \"addevent\",\n    startdt: start,\n    enddt: end,\n    subject: event.title,\n    body: event.description,\n    location: event.location\n  };\n  return `https://outlook.live.com/calendar/0/deeplink/compose?${query_string_1.stringify(details)}`;\n};\n\nexports.outlook = outlook;\n\nconst office365 = calendarEvent => {\n  const event = exports.eventify(calendarEvent);\n  const {\n    start,\n    end\n  } = formatTimes(event, \"dateTimeWithOffset\");\n  const details = {\n    path: \"/calendar/action/compose\",\n    rru: \"addevent\",\n    startdt: start,\n    enddt: end,\n    subject: event.title,\n    body: event.description,\n    location: event.location\n  };\n  return `https://outlook.office.com/calendar/0/deeplink/compose?${query_string_1.stringify(details)}`;\n};\n\nexports.office365 = office365;\n\nconst yahoo = calendarEvent => {\n  const event = exports.eventify(calendarEvent);\n  const {\n    start,\n    end\n  } = formatTimes(event, \"dateTimeUTC\");\n  const details = {\n    v: 60,\n    title: event.title,\n    st: start,\n    et: end,\n    desc: event.description,\n    in_loc: event.location\n  };\n  return `https://calendar.yahoo.com/?${query_string_1.stringify(details)}`;\n};\n\nexports.yahoo = yahoo;\n\nconst ics = calendarEvent => {\n  const event = exports.eventify(calendarEvent);\n  const formattedDescription = (event.description || \"\").replace(/,/gm, \",\").replace(/;/gm, \";\").replace(/\\n/gm, \"\\\\n\").replace(/(\\\\n)[\\s\\t]+/gm, \"\\\\n\");\n  const formattedLocation = (event.location || \"\").replace(/,/gm, \",\").replace(/;/gm, \";\").replace(/\\n/gm, \"\\\\n\").replace(/(\\\\n)[\\s\\t]+/gm, \"\\\\n\");\n  const {\n    start,\n    end\n  } = formatTimes(event, \"dateTimeUTC\");\n  const calendarChunks = [{\n    key: \"BEGIN\",\n    value: \"VCALENDAR\"\n  }, {\n    key: \"VERSION\",\n    value: \"2.0\"\n  }, {\n    key: \"BEGIN\",\n    value: \"VEVENT\"\n  }, {\n    key: \"URL\",\n    value: event.url\n  }, {\n    key: \"DTSTART\",\n    value: start\n  }, {\n    key: \"DTEND\",\n    value: end\n  }, {\n    key: \"SUMMARY\",\n    value: event.title\n  }, {\n    key: \"DESCRIPTION\",\n    value: formattedDescription\n  }, {\n    key: \"LOCATION\",\n    value: formattedLocation\n  }, {\n    key: \"END\",\n    value: \"VEVENT\"\n  }, {\n    key: \"END\",\n    value: \"VCALENDAR\"\n  }];\n  let calendarUrl = \"\";\n  calendarChunks.forEach(chunk => {\n    if (chunk.value) {\n      calendarUrl += `${chunk.key}:${encodeURIComponent(`${chunk.value}\\n`)}`;\n    }\n  });\n  return `data:text/calendar;charset=utf8,${calendarUrl}`;\n};\n\nexports.ics = ics;","map":{"version":3,"sources":["../src/index.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ics = exports.yahoo = exports.office365 = exports.outlook = exports.google = exports.eventify = void 0;\nconst dayjs_1 = __importDefault(require(\"dayjs\"));\nconst utc_1 = __importDefault(require(\"dayjs/plugin/utc\"));\nconst query_string_1 = require(\"query-string\");\nconst utils_1 = require(\"./utils\");\ndayjs_1.default.extend(utc_1.default);\nfunction formatTimes({ allDay, startUtc, endUtc }, dateTimeFormat) {\n    const format = utils_1.TimeFormats[allDay ? \"allDay\" : dateTimeFormat];\n    return { start: startUtc.format(format), end: endUtc.format(format) };\n}\nconst eventify = (event) => {\n    const { start, end, duration, ...rest } = event;\n    const startUtc = dayjs_1.default(start).utc();\n    const endUtc = end\n        ? dayjs_1.default(end).utc()\n        : (() => {\n            if (event.allDay) {\n                return startUtc.add(1, \"day\");\n            }\n            if (duration && duration.length == 2) {\n                const value = Number(duration[0]);\n                const unit = duration[1];\n                return startUtc.add(value, unit);\n            }\n            return dayjs_1.default().utc();\n        })();\n    return {\n        ...rest,\n        startUtc,\n        endUtc,\n    };\n};\nexports.eventify = eventify;\nconst google = (calendarEvent) => {\n    const event = exports.eventify(calendarEvent);\n    const { start, end } = formatTimes(event, \"dateTimeUTC\");\n    const details = {\n        action: \"TEMPLATE\",\n        text: event.title,\n        details: event.description,\n        location: event.location,\n        trp: event.busy,\n        dates: start + \"/\" + end,\n    };\n    if (event.guests && event.guests.length) {\n        details.add = event.guests.join();\n    }\n    return `https://calendar.google.com/calendar/render?${query_string_1.stringify(details)}`;\n};\nexports.google = google;\nconst outlook = (calendarEvent) => {\n    const event = exports.eventify(calendarEvent);\n    const { start, end } = formatTimes(event, \"dateTimeWithOffset\");\n    const details = {\n        path: \"/calendar/action/compose\",\n        rru: \"addevent\",\n        startdt: start,\n        enddt: end,\n        subject: event.title,\n        body: event.description,\n        location: event.location,\n    };\n    return `https://outlook.live.com/calendar/0/deeplink/compose?${query_string_1.stringify(details)}`;\n};\nexports.outlook = outlook;\nconst office365 = (calendarEvent) => {\n    const event = exports.eventify(calendarEvent);\n    const { start, end } = formatTimes(event, \"dateTimeWithOffset\");\n    const details = {\n        path: \"/calendar/action/compose\",\n        rru: \"addevent\",\n        startdt: start,\n        enddt: end,\n        subject: event.title,\n        body: event.description,\n        location: event.location,\n    };\n    return `https://outlook.office.com/calendar/0/deeplink/compose?${query_string_1.stringify(details)}`;\n};\nexports.office365 = office365;\nconst yahoo = (calendarEvent) => {\n    const event = exports.eventify(calendarEvent);\n    const { start, end } = formatTimes(event, \"dateTimeUTC\");\n    const details = {\n        v: 60,\n        title: event.title,\n        st: start,\n        et: end,\n        desc: event.description,\n        in_loc: event.location,\n    };\n    return `https://calendar.yahoo.com/?${query_string_1.stringify(details)}`;\n};\nexports.yahoo = yahoo;\nconst ics = (calendarEvent) => {\n    const event = exports.eventify(calendarEvent);\n    const formattedDescription = (event.description || \"\")\n        .replace(/,/gm, \",\")\n        .replace(/;/gm, \";\")\n        .replace(/\\n/gm, \"\\\\n\")\n        .replace(/(\\\\n)[\\s\\t]+/gm, \"\\\\n\");\n    const formattedLocation = (event.location || \"\")\n        .replace(/,/gm, \",\")\n        .replace(/;/gm, \";\")\n        .replace(/\\n/gm, \"\\\\n\")\n        .replace(/(\\\\n)[\\s\\t]+/gm, \"\\\\n\");\n    const { start, end } = formatTimes(event, \"dateTimeUTC\");\n    const calendarChunks = [\n        {\n            key: \"BEGIN\",\n            value: \"VCALENDAR\",\n        },\n        {\n            key: \"VERSION\",\n            value: \"2.0\",\n        },\n        {\n            key: \"BEGIN\",\n            value: \"VEVENT\",\n        },\n        {\n            key: \"URL\",\n            value: event.url,\n        },\n        {\n            key: \"DTSTART\",\n            value: start,\n        },\n        {\n            key: \"DTEND\",\n            value: end,\n        },\n        {\n            key: \"SUMMARY\",\n            value: event.title,\n        },\n        {\n            key: \"DESCRIPTION\",\n            value: formattedDescription,\n        },\n        {\n            key: \"LOCATION\",\n            value: formattedLocation,\n        },\n        {\n            key: \"END\",\n            value: \"VEVENT\",\n        },\n        {\n            key: \"END\",\n            value: \"VCALENDAR\",\n        },\n    ];\n    let calendarUrl = \"\";\n    calendarChunks.forEach((chunk) => {\n        if (chunk.value) {\n            calendarUrl += `${chunk.key}:${encodeURIComponent(`${chunk.value}\\n`)}`;\n        }\n    });\n    return `data:text/calendar;charset=utf8,${calendarUrl}`;\n};\nexports.ics = ics;\n//# sourceMappingURL=index.js.map"]},"metadata":{},"sourceType":"script"}